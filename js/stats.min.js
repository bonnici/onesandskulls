function injuryDiceToResult(e){if(2!=e.length)return console.log("OOPS - wrong number of dice for injury roll"),console.log(e),null;var t=e[0]+e[1];return 8>t?0:10>t?1:2}function casualtyDiceToResult(e){return 1!=e.length?(console.log("OOPS - wrong number of dice for casualty roll"),console.log(e),null):e[0]<=38?0:e[0]<=48?1:e[0]<=52?2:e[0]<=54?3:e[0]<=56?4:e[0]<=57?5:e[0]<=58?6:7}function initStats(e,t){if(!(t in e)){var r=rollTypeIdToDiceType(t);1==r&&(e[t]={diceType:1,expected:[1/6,1/6,1/6,1/6,1/6,1/6],0:{total:0,histogram:[0,0,0,0,0,0]},1:{total:0,histogram:[0,0,0,0,0,0]}})}}function rollTypeIdToDiceType(e){switch(e){case-2:return 2;case-1:return 6;case 1:return 1;case 2:return 1;case 3:return 3;case 4:return 4;case 5:return 0;case 6:return 1;case 7:return 1;case 8:return 5;case 9:return 1;case 10:return 2;case 11:return 7;case 12:return 1;case 16:return 1;case 17:return 1;case 20:return 1;case 21:return 1;case 22:return 1;case 23:return 1;case 24:return 1;case 26:return 2;case 29:return 1;case 27:return 1;case 31:return 1;case 34:return 3;case 36:return 1;case 37:return 1;case 40:return 1;case 42:return 1;case 46:return 1;case 54:return 1;case 55:return 1;case 56:return 1;case 58:return 2;default:return null}}stats={calculateStats:function(e,t){for(var r={standard:{diceType:1,0:{total:0,histogram:[0,0,0,0,0,0]},1:{total:0,histogram:[0,0,0,0,0,0]},expected:[1/6,1/6,1/6,1/6,1/6,1/6]},scatter:{diceType:2,0:{total:0,histogram:[0,0,0,0,0,0,0,0]},1:{total:0,histogram:[0,0,0,0,0,0,0,0]},expected:[1/8,1/8,1/8,1/8,1/8,1/8,1/8,1/8]},block:{diceType:0,0:{total:0,histogram:[0,0,0,0,0]},1:{total:0,histogram:[0,0,0,0,0]},expected:[1/6,1/6,2/6,1/6,1/6]},"1db":{diceType:0,0:{total:0,histogram:[0,0,0,0,0]},1:{total:0,histogram:[0,0,0,0,0]},expected:[1/6,1/6,2/6,1/6,1/6]},"2db":{diceType:-1,0:{total:0,histogram:[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]},1:{total:0,histogram:[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]},expected:[1/36,2/36,4/36,2/36,2/36,1/36,4/36,2/36,2/36,4/36,4/36,4/36,1/36,2/36,1/36]},armour:{diceType:3,0:{total:0,histogram:[0,0,0,0,0,0,0,0,0,0,0]},1:{total:0,histogram:[0,0,0,0,0,0,0,0,0,0,0]},expected:[1/36,2/36,3/36,4/36,5/36,6/36,5/36,4/36,3/36,2/36,1/36]},injury:{diceType:4,0:{total:0,histogram:[0,0,0]},1:{total:0,histogram:[0,0,0]},expected:[21/36,.25,6/36]},casualty:{diceType:5,0:{total:0,histogram:[0,0,0,0,0,0,0,0]},1:{total:0,histogram:[0,0,0,0,0,0,0,0]},expected:[.5,1/6,2/48,2/48,2/48,1/48,1/48,1/6]}},a=0;a<e.length;a++){var o=e[a],c=o.team;o.player in t&&(c=t[o.player].teamId);var l=o.rollType,i=rollTypeIdToDiceType(l);if(null!==i){if(3==i){for(var s=0,n=0;n<o.dice.length;n++)s+=o.dice[n]-1;r.armour[c].total++,r.armour[c].histogram[s]++}else if(4==i){var u=injuryDiceToResult(o.dice);null!==u&&(r.injury[c].total++,r.injury[c].histogram[u]++)}else if(5==i){var u=casualtyDiceToResult(o.dice);null!==u&&(r.casualty[c].total++,r.casualty[c].histogram[u]++)}else if(null!==i)for(var n=0;n<o.dice.length;n++){var d,g=o.dice[n];0==i?d=r.block[c]:1==i||7==i?(g--,d=r.standard[c]):2==i&&(g--,d=r.scatter[c]),d&&(d.total++,d.histogram[g]++)}if(0===i){if(1==o.dice.length){var g=o.dice[0];r["1db"][c].total++,r["1db"][c].histogram[g]++}else if(2==o.dice.length){for(var h=Math.min(o.dice[0],o.dice[1]),m=Math.max(o.dice[0],o.dice[1]),y=0,p=h;p>0;p--)y+=p;var g=5*h+m-y;r["2db"][c].total++,r["2db"][c].histogram[g]++}}else if(1==i)if(o.dice.length>1)console.log("OOPS - skipping action with valid rollType "+l),console.log(o);else{initStats(r,l);var g=o.dice[0]-1;r[l][c].total++,r[l][c].histogram[g]++}}}return r}};